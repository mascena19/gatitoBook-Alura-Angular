{"ast":null,"code":"import { switchMap, tap } from 'rxjs/operators';\nimport { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./comentarios.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../../../componentes/mensagem/mensagem.component\";\n\nfunction ComentariosComponent_div_0_li_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"p\", 10);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"em\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 11);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const comentario_r4 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(comentario_r4.userName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 3, comentario_r4.date, \"dd/MM/yyyy HH:mm\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(comentario_r4.text);\n  }\n}\n\nfunction ComentariosComponent_div_0_app_mensagem_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-mensagem\", 12);\n  }\n}\n\nfunction ComentariosComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"ul\", 1);\n    i0.ɵɵtemplate(2, ComentariosComponent_div_0_li_2_Template, 8, 6, \"li\", 2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 3)(4, \"form\", 4);\n    i0.ɵɵlistener(\"submit\", function ComentariosComponent_div_0_Template_form_submit_4_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.gravar());\n    });\n    i0.ɵɵelementStart(5, \"div\", 5);\n    i0.ɵɵelement(6, \"textarea\", 6);\n    i0.ɵɵelementStart(7, \"div\", 7)(8, \"button\", 8);\n    i0.ɵɵtext(9, \"Publicar\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵtemplate(10, ComentariosComponent_div_0_app_mensagem_10_Template, 1, 0, \"app-mensagem\", 9);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const comentarios_r1 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    let tmp_3_0;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", comentarios_r1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.comentarioForm);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.comentarioForm.invalid);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !!((tmp_3_0 = ctx_r0.comentarioForm.get(\"comentario\")) == null ? null : tmp_3_0.errors == null ? null : tmp_3_0.errors[\"maxLength\"]));\n  }\n}\n\nexport class ComentariosComponent {\n  constructor(comentariosService, formBuilder) {\n    this.comentariosService = comentariosService;\n    this.formBuilder = formBuilder;\n  }\n\n  ngOnInit() {\n    this.comentarios$ = this.comentariosService.buscarComentario(this.id);\n    this.comentarioForm = this.formBuilder.group({\n      comentario: ['', Validators.maxLength(300)]\n    });\n  }\n\n  gravar() {\n    const comentario = this.comentarioForm.get('comentario')?.value ?? '';\n    this.comentarios$ = this.comentariosService.incluiComentario(this.id, comentario).pipe(switchMap(() => this.comentariosService.buscarComentario(this.id)), tap(() => {\n      this.comentarioForm.reset();\n      alert('Comentário Salvo');\n    }));\n  }\n\n}\n\nComentariosComponent.ɵfac = function ComentariosComponent_Factory(t) {\n  return new (t || ComentariosComponent)(i0.ɵɵdirectiveInject(i1.ComentariosService), i0.ɵɵdirectiveInject(i2.FormBuilder));\n};\n\nComentariosComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ComentariosComponent,\n  selectors: [[\"app-comentarios\"]],\n  inputs: {\n    id: \"id\"\n  },\n  decls: 2,\n  vars: 3,\n  consts: [[4, \"ngIf\"], [1, \"list-unstyled\", \"comentario-list\"], [4, \"ngFor\", \"ngForOf\"], [1, \"mt-4\"], [3, \"formGroup\", \"submit\"], [1, \"input-group\"], [\"formControlName\", \"comentario\", 1, \"form-control\"], [1, \"input-group-append\"], [1, \"btn\", \"btn-primary\", \"pull-left\", 3, \"disabled\"], [\"mensagem\", \"Tamanho m\\u00E1ximo de 300 caracteres\", 4, \"ngIf\"], [1, \"text-dark\", \"font-weight-bold\", \"mr-1\"], [1, \"break-word\", \"mb-2\"], [\"mensagem\", \"Tamanho m\\u00E1ximo de 300 caracteres\"]],\n  template: function ComentariosComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, ComentariosComponent_div_0_Template, 11, 4, \"div\", 0);\n      i0.ɵɵpipe(1, \"async\");\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(1, 1, ctx.comentarios$));\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf, i4.MensagemComponent, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName, i3.AsyncPipe, i3.DatePipe],\n  styles: [\".comentario-list[_ngcontent-%COMP%] {\\r\\n   height: 50vh;\\r\\n   overflow-y: auto;\\r\\n }\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbWVudGFyaW9zLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkNBQUM7R0FDRSxZQUFZO0dBQ1osZ0JBQWdCO0NBQ2xCIiwiZmlsZSI6ImNvbWVudGFyaW9zLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgLmNvbWVudGFyaW8tbGlzdCB7XHJcbiAgIGhlaWdodDogNTB2aDtcclxuICAgb3ZlcmZsb3cteTogYXV0bztcclxuIH1cclxuIl19 */\"]\n});","map":{"version":3,"mappings":"AAAA,SAASA,SAAT,EAAoBC,GAApB,QAA+B,gBAA/B;AAEA,SAAiCC,UAAjC,QAAmD,gBAAnD;;;;;;;;;ICAIC,2BAA2C,CAA3C,EAA2C,GAA3C,EAA2C,EAA3C;IAC6CA;IAAyBA;IACpEA;IAAIA;;IAA+CA;IACnDA;IAA2BA;IAAqBA;;;;;IAFLA;IAAAA;IACvCA;IAAAA;IACuBA;IAAAA;;;;;;IAa7BA;;;;;;;;IAlBJA,4BAAiD,CAAjD,EAAiD,IAAjD,EAAiD,CAAjD;IAEIA;IAKFA;IAEAA,+BAAkB,CAAlB,EAAkB,MAAlB,EAAkB,CAAlB;IACqCA;MAAAA;MAAA;MAAA,OAAUA,+BAAV;IAAkB,CAAlB;IACjCA;IACEA;IACAA,+BAAgC,CAAhC,EAAgC,QAAhC,EAAgC,CAAhC;IACgFA;IAAQA;IAI5FA;IAGFA;;;;;;;IAnB6BA;IAAAA;IAQrBA;IAAAA;IAIQA;IAAAA;IAKbA;IAAAA;;;;ADPL,OAAM,MAAOC,oBAAP,CAA2B;EAM/BC,YAAoBC,kBAApB,EAAoEC,WAApE,EAA4F;IAAxE;IAAgD;EAA6B;;EAEjGC,QAAQ;IACN,KAAKC,YAAL,GAAoB,KAAKH,kBAAL,CAAwBI,gBAAxB,CAAyC,KAAKC,EAA9C,CAApB;IACA,KAAKC,cAAL,GAAsB,KAAKL,WAAL,CAAiBM,KAAjB,CAAuB;MAC3CC,UAAU,EAAC,CAAC,EAAD,EAAKZ,UAAU,CAACa,SAAX,CAAqB,GAArB,CAAL;IADgC,CAAvB,CAAtB;EAGD;;EAEDC,MAAM;IACJ,MAAMF,UAAU,GAAG,KAAKF,cAAL,CAAoBK,GAApB,CAAwB,YAAxB,GAAuCC,KAAvC,IAAgD,EAAnE;IACA,KAAKT,YAAL,GAAoB,KAAKH,kBAAL,CAAwBa,gBAAxB,CAAyC,KAAKR,EAA9C,EAAkDG,UAAlD,EACnBM,IADmB,CACdpB,SAAS,CAAC,MACd,KAAKM,kBAAL,CAAwBI,gBAAxB,CAAyC,KAAKC,EAA9C,CADa,CADK,EAGlBV,GAAG,CAAC,MAAI;MACN,KAAKW,cAAL,CAAoBS,KAApB;MACAC,KAAK,CAAC,kBAAD,CAAL;IACD,CAHE,CAHe,CAApB;EAQD;;AAzB8B;;;mBAApBlB,sBAAoBD;AAAA;;;QAApBC;EAAoBmB;EAAAC;IAAAb;EAAA;EAAAc;EAAAC;EAAAC;EAAAC;IAAA;MCZjCzB;;;;;MAAMA","names":["switchMap","tap","Validators","i0","ComentariosComponent","constructor","comentariosService","formBuilder","ngOnInit","comentarios$","buscarComentario","id","comentarioForm","group","comentario","maxLength","gravar","get","value","incluiComentario","pipe","reset","alert","selectors","inputs","decls","vars","consts","template"],"sourceRoot":"","sources":["D:\\Desenvolvimento\\workspace\\gatitobook\\src\\app\\animais\\detalhe-animal\\comentarios\\comentarios.component.ts","D:\\Desenvolvimento\\workspace\\gatitobook\\src\\app\\animais\\detalhe-animal\\comentarios\\comentarios.component.html"],"sourcesContent":["import { switchMap, tap } from 'rxjs/operators';\nimport { ComentariosService } from './comentarios.service';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { Observable } from 'rxjs';\nimport { Component, Input, OnInit } from '@angular/core';\nimport { Comentarios } from './comentarios';\n\n@Component({\n  selector: 'app-comentarios',\n  templateUrl: './comentarios.component.html',\n  styleUrls: ['./comentarios.component.css']\n})\nexport class ComentariosComponent implements OnInit {\n\n  @Input() id!: number;\n  comentarios$ !: Observable<Comentarios>;\n  comentarioForm!: FormGroup;\n\n  constructor(private comentariosService: ComentariosService, private formBuilder: FormBuilder) { }\n\n  ngOnInit(): void {\n    this.comentarios$ = this.comentariosService.buscarComentario(this.id);\n    this.comentarioForm = this.formBuilder.group({\n      comentario:['', Validators.maxLength(300)]\n    })\n  }\n\n  gravar(): void {\n    const comentario = this.comentarioForm.get('comentario')?.value ?? '';\n    this.comentarios$ = this.comentariosService.incluiComentario(this.id, comentario)\n    .pipe(switchMap(()=>\n      this.comentariosService.buscarComentario(this.id)),\n      tap(()=> {\n        this.comentarioForm.reset();\n        alert('Comentário Salvo');\n      })\n    );\n  }\n}\n","<div *ngIf=\"comentarios$ | async as comentarios\">\n  <ul class=\"list-unstyled comentario-list\">\n    <li *ngFor=\"let comentario of comentarios\">\n      <p class=\"text-dark font-weight-bold mr-1\">{{ comentario.userName }}</p>\n      <em>{{ comentario.date | date:\"dd/MM/yyyy HH:mm\" }}</em>\n      <p class=\"break-word mb-2\">{{ comentario.text }}</p>\n    </li>\n  </ul>\n\n  <div class=\"mt-4\">\n    <form [formGroup]=\"comentarioForm\" (submit)=\"gravar()\" >\n      <div class=\"input-group\">\n        <textarea class=\"form-control\" formControlName=\"comentario\"></textarea>\n        <div class=\"input-group-append\">\n          <button [disabled]=\"comentarioForm.invalid\" class=\"btn btn-primary pull-left\">Publicar</button>\n        </div>\n      </div>\n    </form>\n    <app-mensagem mensagem=\"Tamanho máximo de 300 caracteres\"\n    *ngIf=\"!!comentarioForm.get('comentario')?.errors?.['maxLength']\"\n    ></app-mensagem>\n  </div>\n</div>\n"]},"metadata":{},"sourceType":"module"}